<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="assets/logo.png">
    <title>Dashboard SIPINTAS</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        body {
            min-height: 100vh;
            display: flex;
        }
        .sidebar {
            min-width: 250px;
            max-width: 350px;
            background-color: #0d6efd;
            color: white;
            transition: all 0.3s;
        }
        .sidebar.collapsed {
            min-width: 70px;
            max-width: 70px;
        }
        .sidebar .nav-link {
            color: white;
            white-space: nowrap;
        }
        .sidebar .nav-link:hover {
            background-color: rgba(255,255,255,0.2);
        }
        .sidebar .nav-link.active {
            background-color: rgba(255,255,255,0.3);
        }
        .sidebar .nav-link .label {
            transition: opacity 0.3s;
        }
        .sidebar.collapsed .nav-link .label {
            opacity: 0;
            pointer-events: none;
        }
        .sidebar .toggle-btn {
            cursor: pointer;
            padding: 10px;
            display: flex;
            justify-content: flex-end;
            color: white;
        }
        .sidebar.collapsed .toggle-btn {
            justify-content: center;
        }
        .content {
            flex: 1;
            padding: 20px;
            background-color: #f8f9fa;
            transition: margin-left 0.3s;
        }
    </style>
</head>
<body>

    <!-- Sidebar -->
    <div class="sidebar d-flex flex-column p-2" id="sidebar">
        <div class="toggle-btn" id="toggleSidebar">
            <i class="bi bi-list fs-4"></i>
        </div>
        <ul class="nav nav-pills flex-column mb-auto">
            <li>
                <a href="index.html" class="nav-link">
                    <i class="bi bi-house me-2"></i>
                    <span class="label">Home</span>
                </a>
            </li>            
            <li>
                <a class="nav-link dropdown-toggle" data-bs-toggle="collapse" href="#skripsiMenu" role="button" aria-expanded="false">
                    <i class="bi bi-journal-text me-2"></i>
                    <span class="label">Penilaian Skripsi</span>
                </a>
                <div class="collapse ps-3" id="skripsiMenu">
                    <ul class="nav flex-column">
                        <li><a href="#" onclick="loadPage('skripsi/dashboard_proposalskripsi.html', 'proposalskripsi')" class="nav-link">Penilaian Seminar Proposal</a></li>
                        <li><a href="#" onclick="loadPage('skripsi/dashboard_ujianskripsi.html', 'ujianskripsi')" class="nav-link">Penilaian Seminar Akhir</a></li>
                        <li><a href="#" onclick="loadPage('skripsi/dashboard_rekapskripsi.html', 'rekapskripsi')" class="nav-link">Rekapitulasi</a></li>
                    </ul>
                </div>
            </li>
            <li>
                <a class="nav-link dropdown-toggle" data-bs-toggle="collapse" href="#tesisMenu" role="button" aria-expanded="false">
                    <i class="bi bi-book me-2"></i>
                    <span class="label">Penilaian Tesis</span>
                </a>
                <div class="collapse ps-3" id="tesisMenu">
                    <ul class="nav flex-column">
                        <li><a href="#" onclick="loadPage('tesis/dashboard_proposaltesis.html', 'proposaltesis')" class="nav-link">Penilaian Proposal</a></li>
                        <li><a href="#" onclick="loadPage('tesis/dashboard_publikasitesis.html', 'publikasitesis')" class="nav-link">Penilaian Naskah Publikasi</a></li>
                        <li><a href="#" onclick="loadPage('tesis/dashboard_ujiantesis.html', 'ujiantesis')" class="nav-link">Penilaian Sidang Akhir</a></li>
                        <li><a href="#" onclick="loadPage('tesis/dashboard_rekaptesis.html', 'rekaptesis')" class="nav-link">Rekapitulasi</a></li>
                    </ul>
                </div>
            </li>
            <li>
                <a class="nav-link dropdown-toggle" data-bs-toggle="collapse" href="#disertasiMenu" role="button" aria-expanded="false">
                    <i class="bi bi-mortarboard me-2"></i>
                    <span class="label">Penilaian Disertasi</span>
                </a>
                <div class="collapse ps-3" id="disertasiMenu">
                    <ul class="nav flex-column">
                        <li><a href="#" onclick="loadPage('disertasi/dashboard_ujiankomprehensif.html', 'ujiankomprehensifdisertasi')" class="nav-link">Ujian Komprehensif</a></li>
                        <li><a href="#" onclick="loadPage('disertasi/dashboard_seminar1.html', 'disertasiseminar1')" class="nav-link">Seminar 1</a></li>
                        <li><a href="#" onclick="loadPage('disertasi/dashboard_seminar2.html', 'disertasiseminar2')" class="nav-link">Seminar 2</a></li>
                        <li><a href="#" onclick="loadPage('disertasi/dashboard_publikasidisertasi.html', 'publikasidisertasi')" class="nav-link">Penilaian Disertasi & Publikasi</a></li>
                        <li><a href="#" onclick="loadPage('disertasi/dashboard_ujiantertutup.html', 'ujiantertutupdisertasi')" class="nav-link">Ujian Tertutup</a></li>
                        <li><a href="#" onclick="loadPage('disertasi/dashboard_naskahakhir.html', 'naskahakhirdisertasi')" class="nav-link">Naskah Akhir</a></li>
                        <li><a href="#" onclick="loadPage('disertasi/dashboard_kinerja.html', 'kinerjadisertasi')" class="nav-link">Kinerja</a></li>
                        <li><a href="#" onclick="loadPage('disertasi/dashboard_rekapdisertasi.html', 'rekapdisertasi')" class="nav-link">Rekapitulasi</a></li>
                    </ul>
                </div>
            </li>
            <li>
                <a class="nav-link dropdown-toggle" data-bs-toggle="collapse" href="#kkMenu" role="button" aria-expanded="false">
                    <i class="bi bi-geo-alt me-2"></i>
                    <span class="label">Penilaian Kemah Kerja</span>
                </a>
                <div class="collapse ps-3" id="kkMenu">
                    <ul class="nav flex-column">
                        <li><a href="#" onclick="loadPage('kemahkerja/dashboard_pretestkk.html', 'pretestkk')" class="nav-link">Pre-Test KK</a></li>
                        <li><a href="#" onclick="loadPage('kemahkerja/dashboard_kkshift1.html', 'kkshift1')" class="nav-link">Shift 1</a></li>
                        <li><a href="#" onclick="loadPage('kemahkerja/dashboard_kkshift2.html', 'kkshift2')" class="nav-link">Shift 2</a></li>
                        <li><a href="#" onclick="loadPage('kemahkerja/dashboard_kkshift3.html', 'kkshift3')" class="nav-link">Shift 3</a></li>
                        <li><a href="#" onclick="loadPage('kemahkerja/dashboard_kkstudio.html', 'kkstudio')" class="nav-link">Studio</a></li>
                    </ul>
                </div>
            </li>
            <li><a href="#" class="nav-link"><i class="bi bi-briefcase me-2"></i> <span class="label">Penilaian Kerja Praktik</span></a></li>
            <li><a href="#" class="nav-link"><i class="bi bi-diagram-3 me-2"></i> <span class="label">Penilaian PRGG</span></a></li>
        </ul>
    </div>

    <!-- Content -->
    <div class="content">
        <div id="mainContent">
            <h2 class="fw-bold text-primary">Selamat Datang di SIPINTAS</h2>
            <h3 class="text-secondary">Sistem Penilaian Terintegrasi Sistematis</h3>
            <p class="text-muted">
                Dashboard ini merupakan sistem untuk mempermudah Dosen Departemen Teknik Geodesi Fakultas Teknik Universitas Gadjah Mada dalam melakukan penilaian, khususnya tugas akhir (Skripsi, Tesis, Disertasi), Kemah Kerja, Kerja Praktik, dan PRGG (Capstone Design). 
                Sistem terintegrasi ke dalam basisdata dan tersimpan dengan sistematis. 
                <br><br><strong>Silakan pilih menu di sebelah kiri untuk memulai penilaian!</strong>
            </p>

            <!-- Grafik sekarang ada DI DALAM mainContent -->
            <div class="row mt-4">
                <div class="col-md-6">
                    <div class="card shadow-sm p-3 mb-4" style="height: 400px;">
                        <canvas id="skripsiChart"></canvas>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card shadow-sm p-3 mb-4" style="height: 400px;">
                        <canvas id="tesisChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>



    <script src="skripsi/proposalskripsi.js"></script>
    <script src="skripsi/ujianskripsi.js"></script>
    <script src="skripsi/rekapskripsi.js"></script>
    <script src="tesis/proposaltesis.js"></script>
    <script src="tesis/publikasis2.js"></script>
    <script src="tesis/ujiantesis.js"></script>
    <script src="tesis/rekaptesis.js"></script>
    <script src="disertasi/ujianKomprehensif.js"></script>
    <script src="disertasi/seminar1.js"></script>
    <script src="disertasi/seminar2.js"></script>
    <script src="disertasi/publikasidisertasi.js"></script>
    <script src="disertasi/ujianTertutup.js"></script>
    <script src="disertasi/naskahakhir.js"></script>
    <script src="disertasi/kinerja.js"></script>
    <script src="disertasi/rekapdisertasi.js"></script>
    <script src="kemahkerja/pretestkk.js"></script>
    <script src="kemahkerja/kkshift1.js"></script>
    <script src="kemahkerja/kkshift2.js"></script>
    <script src="kemahkerja/kkshift3.js"></script>
    <script src="kemahkerja/kkstudio.js"></script>
    <script src="dashboard.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.getElementById('toggleSidebar').addEventListener('click', function () {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('collapsed');

            // Tutup semua submenu ketika sidebar dicollapse
            if (sidebar.classList.contains('collapsed')) {
                document.querySelectorAll('.sidebar .collapse.show').forEach(el => {
                    const bsCollapse = bootstrap.Collapse.getInstance(el);
                    if (bsCollapse) {
                        bsCollapse.hide();
                    } else {
                        new bootstrap.Collapse(el, { toggle: false }).hide();
                    }
                });
            }
        });

        function loadPage(page, key) {
            fetch(page)
                .then(res => res.text())
                .then(html => {
                    document.getElementById("mainContent").innerHTML = html;

                    if (page === "skripsi/dashboard_proposalskripsi.html") {
                        loadProposalSkripsiData(); 
                    } if (page === "skripsi/dashboard_ujianskripsi.html") {
                        loadUjianSkripsiData(); 
                    } if (page === "skripsi/dashboard_rekapskripsi.html") {
                        loadRekapSkripsiData(); 
                    } if (page === "tesis/dashboard_proposaltesis.html") {
                        loadProposalData();
                    } if (page === "tesis/dashboard_publikasitesis.html") {
                        loadPublikasiS2Data(); 
                    } if (page === "tesis/dashboard_ujiantesis.html") {
                        loadUjianTesisData(); 
                    } if (page === "tesis/dashboard_rekaptesis.html") {
                        loadRekapTesisData(); 
                    } if (page === "disertasi/dashboard_ujiankomprehensif.html") {
                        loadQualificationAssessmentData(); 
                    } if (page === "disertasi/dashboard_seminar1.html") {
                        loadSeminar1Data(); 
                    } if (page === "disertasi/dashboard_seminar2.html") {
                        loadSeminar2Data(); 
                    } if (page === "disertasi/dashboard_publikasidisertasi.html") {
                        loadUjianKelayakanData(); 
                    } if (page === "disertasi/dashboard_ujiantertutup.html") {
                        loadujianTertutupData(); 
                    } if (page === "disertasi/dashboard_naskahakhir.html") {
                        loadnaskahAkhirData(); 
                    } if (page === "disertasi/dashboard_kinerja.html") {
                        loadKinerjaData(); 
                    } if (page === "disertasi/dashboard_rekapdisertasi.html") {
                        loadRekapDisertasiData(); 
                    } if (page === "kemahkerja/dashboard_pretestkk.html") {
                        loadPreTestKKData(); 
                    } if (page === "kemahkerja/dashboard_kkshift1.html") {
                        loadKKShift1Data(); 
                    } if (page === "kemahkerja/dashboard_kkshift2.html") {
                        loadKKShift2Data(); 
                    } if (page === "kemahkerja/dashboard_kkshift3.html") {
                        loadKKShift3Data(); 
                    } if (page === "kemahkerja/dashboard_kkstudio.html") {
                        loadKKStudioData(); 
                    }

                    history.pushState({page}, "", `?page=${key}`);
                })
                .catch(err => {
                    document.getElementById("mainContent").innerHTML = "<p class='text-danger'>Gagal memuat halaman.</p>";
                    console.error(err);
                });
        }

        document.addEventListener("DOMContentLoaded", () => {
            const params = new URLSearchParams(window.location.search);
            const pageKey = params.get("page");

            if (pageKey === "proposalskripsi") {
                loadPage("skripsi/dashboard_proposalskripsi.html", "proposalskripsi");
            } else if (pageKey === "ujianskripsi") {
                loadPage("skripsi/dashboard_ujianskripsi.html", "ujianskripsi");
            } else if (pageKey === "rekapskripsi") {
                loadPage("skripsi/dashboard_rekapskripsi.html", "rekapskripsi");
            } 
            
            else if (pageKey === "proposaltesis") {
                loadPage("tesis/dashboard_proposaltesis.html", "proposaltesis");
            } else if (pageKey === "publikasitesis") {
                loadPage("tesis/dashboard_publikasitesis.html", "publikasitesis");
            } else if (pageKey === "ujiantesis") {
                loadPage("tesis/dashboard_ujiantesis.html", "ujiantesis");
            } else if (pageKey === "rekaptesis") {
                loadPage("tesis/dashboard_rekaptesis.html", "rekaptesis");
            } else if (pageKey === "rekaptesis") {
                loadPage("tesis/dashboard_rekaptesis.html", "rekaptesis");
            } 
            
            else if (pageKey === "ujiankomprehensifdisertasi") {
                loadPage("disertasi/dashboard_ujiankomprehensif.html", "ujiankomprehensifdisertasi");
            } else if (pageKey === "disertasiseminar1") {
                loadPage("disertasi/dashboard_seminar1.html", "disertasiseminar1");
            } else if (pageKey === "disertasiseminar2") {
                loadPage("disertasi/dashboard_seminar2.html", "disertasiseminar2");
            } else if (pageKey === "publikasidisertasi") {
                loadPage("disertasi/dashboard_publikasidisertasi.html", "publikasidisertasi");
            } else if (pageKey === "ujiantertutupdisertasi") {
                loadPage("disertasi/dashboard_ujiantertutup.html", "ujiantertutupdisertasi");
            } else if (pageKey === "naskahakhirdisertasi") {
                loadPage("disertasi/dashboard_naskahakhir.html", "naskahakhirdisertasi");
            } else if (pageKey === "kinerjadisertasi") {
                loadPage("disertasi/dashboard_kinerja.html", "kinerjadisertasi");
            } else if (pageKey === "rekapdisertasi") {
                loadPage("disertasi/dashboard_rekapdisertasi.html", "rekapdisertasi");
            } 
            
            else if (pageKey === "pretestkk") {
                loadPage("kemahkerja/dashboard_pretestkk.html", "pretestkk");
            } else if (pageKey === "kkshift1") {
                loadPage("kemahkerja/dashboard_kkshift1.html", "kkshift1");
            } else if (pageKey === "kkshift2") {
                loadPage("kemahkerja/dashboard_kkshift2.html", "kkshift2");
            } else if (pageKey === "kkshift3") {
                loadPage("kemahkerja/dashboard_kkshift3.html", "kkshift3");
            } else if (pageKey === "kkstudio") {
                loadPage("kemahkerja/dashboard_kkstudio.html", "kkstudio");
            } 
            
            else {
                
            }
        });
    </script>
</body>
</html>